local a = {
	far = 438,
	graphic = {
		"sm_des_bush2",
		"sm_des_bush3",
		"shad_car",
		"sm_des_bush1",
		"newtreeleaves128",
		"cloudmasked",
		"coronastar",
		"splash_up1",
		"splash_up2"
	}
}

texShader = dxCreateShader("assets/texreplace.fx")
smoke = dxCreateTexture("assets/hidden.png")
local b, c = guiGetScreenSize()

addEventHandler("onClientResourceStart", resourceRoot,
	function()
		SHADER = dxCreateShader("assets/shader.fx")
		TEXTURE = dxCreateTexture("assets/invisible.png")
		if SHADER and TEXTURE then
			dxSetShaderValue(SHADER, "Tex0", TEXTURE)
		end
		for d, e in ipairs(getElementsByType("object")) do
			local f = getElementModel(e)
			engineSetModelLODDistance(f, 50)
		end
	end
)

function increase()
	for d, e in ipairs(getElementsByType("object")) do
		local f = getElementModel(e)
		engineSetModelLODDistance(f, 50)
	end
	setHeatHaze(0)
	setInteriorSoundsEnabled(false)
	setBlurLevel(0)
	setCameraClip(false, false)
	removeWorldModel(616, 10000, 0, 0, 0)
	removeWorldModel(620, 10000, 0, 0, 0)
	removeWorldModel(673, 10000, 0, 0, 0)
	removeWorldModel(669, 10000, 0, 0, 0)
	removeWorldModel(621, 10000, 0, 0, 0)
	removeWorldModel(645, 10000, 0, 0, 0)
	removeWorldModel(712, 10000, 0, 0, 0)
	removeWorldModel(618, 10000, 0, 0, 0)
	removeWorldModel(661, 10000, 0, 0, 0)
	removeWorldModel(691, 10000, 0, 0, 0)
	removeWorldModel(715, 10000, 0, 0, 0)
	removeWorldModel(726, 10000, 0, 0, 0)
	removeWorldModel(625, 10000, 0, 0, 0)
	removeWorldModel(716, 10000, 0, 0, 0)
	removeWorldModel(733, 10000, 0, 0, 0)
	removeWorldModel(730, 10000, 0, 0, 0)
	removeWorldModel(708, 10000, 0, 0, 0)
	removeWorldModel(706, 10000, 0, 0, 0)
	removeWorldModel(707, 10000, 0, 0, 0)
	removeWorldModel(670, 10000, 0, 0, 0)
	removeWorldModel(727, 10000, 0, 0, 0)
	removeWorldModel(885, 10000, 0, 0, 0)
	removeWorldModel(791, 10000, 0, 0, 0)
	removeWorldModel(689, 10000, 0, 0, 0)
	removeWorldModel(690, 10000, 0, 0, 0)
	removeWorldModel(773, 10000, 0, 0, 0)
	removeWorldModel(729, 10000, 0, 0, 0)
	removeWorldModel(696, 10000, 0, 0, 0)
	removeWorldModel(672, 10000, 0, 0, 0)
	removeWorldModel(694, 10000, 0, 0, 0)
	removeWorldModel(790, 10000, 0, 0, 0)
	removeWorldModel(766, 10000, 0, 0, 0)
	removeWorldModel(768, 10000, 0, 0, 0)
	removeWorldModel(709, 10000, 0, 0, 0)
	removeWorldModel(693, 10000, 0, 0, 0)
	removeWorldModel(5292, 10000, 0, 0, 0)
	removeWorldModel(5295, 10000, 0, 0, 0)
	removeWorldModel(7076, 10000, 0, 0, 0)
	removeWorldModel(7077, 10000, 0, 0, 0)
	removeWorldModel(7078, 10000, 0, 0, 0)
	removeWorldModel(7080, 10000, 0, 0, 0)
	removeWorldModel(7086, 10000, 0, 0, 0)
	removeWorldModel(7543, 10000, 0, 0, 0)
	removeWorldModel(7563, 10000, 0, 0, 0)
	removeWorldModel(7569, 10000, 0, 0, 0)
	removeWorldModel(7573, 10000, 0, 0, 0)
	removeWorldModel(7598, 10000, 0, 0, 0)
	removeWorldModel(7607, 10000, 0, 0, 0)
	removeWorldModel(7608, 10000, 0, 0, 0)
	removeWorldModel(7637, 10000, 0, 0, 0)
	removeWorldModel(7640, 10000, 0, 0, 0)
	removeWorldModel(7648, 10000, 0, 0, 0)
	removeWorldModel(7649, 10000, 0, 0, 0)
	removeWorldModel(10669, 10000, 0, 0, 0)
	removeWorldModel(10712, 10000, 0, 0, 0)
	removeWorldModel(10736, 10000, 0, 0, 0)
	removeWorldModel(10738, 10000, 0, 0, 0)
	removeWorldModel(10739, 10000, 0, 0, 0)
	removeWorldModel(10742, 10000, 0, 0, 0)
	removeWorldModel(10743, 10000, 0, 0, 0)
	removeWorldModel(11561, 10000, 0, 0, 0)
	removeWorldModel(11608, 10000, 0, 0, 0)
	removeWorldModel(13205, 10000, 0, 0, 0)
	removeWorldModel(13451, 10000, 0, 0, 0)
	removeWorldModel(13452, 10000, 0, 0, 0)
	removeWorldModel(13863, 10000, 0, 0, 0)
	removeWorldModel(16044, 10000, 0, 0, 0)
	removeWorldModel(16046, 10000, 0, 0, 0)
	removeWorldModel(16268, 10000, 0, 0, 0)
	removeWorldModel(16284, 10000, 0, 0, 0)
	removeWorldModel(16373, 10000, 0, 0, 0)
	removeWorldModel(16741, 10000, 0, 0, 0)
	removeWorldModel(16743, 10000, 0, 0, 0)
	removeWorldModel(16745, 10000, 0, 0, 0)
	removeWorldModel(18211, 10000, 0, 0, 0)
	removeWorldModel(697, 10000, 0, 0, 0)
	removeWorldModel(3244, 10000, 0, 0, 0)
	removeWorldModel(8607, 10000, 0, 0, 0)
	removeWorldModel(8595, 10000, 0, 0, 0)
	removeWorldModel(8085, 10000, 0, 0, 0)
	removeWorldModel(8086, 10000, 0, 0, 0)
	removeWorldModel(713, 10000, 0, 0, 0)
	removeWorldModel(731, 10000, 0, 0, 0)
	removeWorldModel(772, 10000, 0, 0, 0)
	removeWorldModel(774, 10000, 0, 0, 0)
	removeWorldModel(705, 10000, 0, 0, 0)
	removeWorldModel(703, 10000, 0, 0, 0)
	removeWorldModel(688, 10000, 0, 0, 0)
	removeWorldModel(698, 10000, 0, 0, 0)
	removeWorldModel(658, 10000, 0, 0, 0)
	removeWorldModel(767, 10000, 0, 0, 0)
	removeWorldModel(652, 10000, 0, 0, 0)
	removeWorldModel(700, 10000, 0, 0, 0)
	removeWorldModel(687, 10000, 0, 0, 0)
	removeWorldModel(18271, 10000, 0, 0, 0)
	removeWorldModel(654, 10000, 0, 0, 0)
	removeWorldModel(655, 10000, 0, 0, 0)
	removeWorldModel(778, 10000, 0, 0, 0)
	removeWorldModel(737, 10000, 0, 0, 0)
	removeWorldModel(18268, 10000, 0, 0, 0)
	removeWorldModel(18327, 10000, 0, 0, 0)
	removeWorldModel(18270, 10000, 0, 0, 0)
	removeWorldModel(18272, 10000, 0, 0, 0)
	removeWorldModel(656, 10000, 0, 0, 0)
	removeWorldModel(735, 10000, 0, 0, 0)
	removeWorldModel(736, 10000, 0, 0, 0)
	removeWorldModel(763, 10000, 0, 0, 0)
	removeWorldModel(615, 10000, 0, 0, 0)
	removeWorldModel(775, 10000, 0, 0, 0)
	removeWorldModel(635, 10000, 0, 0, 0)
	removeWorldModel(710, 10000, 0, 0, 0)
	removeWorldModel(659, 10000, 0, 0, 0)
	removeWorldModel(676, 10000, 0, 0, 0)
	removeWorldModel(680, 10000, 0, 0, 0)
	removeWorldModel(738, 10000, 0, 0, 0)
	removeWorldModel(3509, 10000, 0, 0, 0)
	removeWorldModel(671, 10000, 0, 0, 0)
	removeWorldModel(7517, 10000, 0, 0, 0)
	removeWorldModel(622, 10000, 0, 0, 0)
	removeWorldModel(623, 10000, 0, 0, 0)
	removeWorldModel(1278, 10000, 0, 0, 0)
	removeWorldModel(3460, 10000, 0, 0, 0)
	removeWorldModel(1290, 10000, 0, 0, 0)
	removeWorldModel(1231, 10000, 0, 0, 0)
	removeWorldModel(7481, 10000, 0, 0, 0)
	removeWorldModel(7447, 10000, 0, 0, 0)
	removeWorldModel(651, 10000, 0, 0, 0)
	removeWorldModel(7462, 10000, 0, 0, 0)
	removeWorldModel(904, 10000, 0, 0, 0)
	removeWorldModel(858, 10000, 0, 0, 0)
	removeWorldModel(7483, 10000, 0, 0, 0)
	removeWorldModel(617, 10000, 0, 0, 0)
	removeWorldModel(7291, 10000, 0, 0, 0)
	removeWorldModel(6933, 10000, 0, 0, 0)
	removeWorldModel(6934, 10000, 0, 0, 0)
	removeWorldModel(6932, 10000, 0, 0, 0)
	removeWorldModel(1259, 10000, 0, 0, 0)
	removeWorldModel(739, 10000, 0, 0, 0)
	removeWorldModel(1391, 10000, 0, 0, 0)
	removeWorldModel(1388, 10000, 0, 0, 0)
	removeWorldModel(5838, 10000, 0, 0, 0)
	removeWorldModel(777, 10000, 0, 0, 0)
	removeWorldModel(770, 10000, 0, 0, 0)
	removeWorldModel(776, 10000, 0, 0, 0)
	removeWorldModel(764, 10000, 0, 0, 0)
	removeWorldModel(769, 10000, 0, 0, 0)
	removeWorldModel(771, 10000, 0, 0, 0)
	removeWorldModel(765, 10000, 0, 0, 0)
	removeWorldModel(1297, 10000, 0, 0, 0)
	removeWorldModel(733, 10000, 0, 0, 0)
	engineRemoveShaderFromWorldTexture(texShader, "collisionsmoke")
	setFarClipDistance(a.far)
	setFogDistance(a.far - 175)
	setCloudsEnabled(false)
	setMoonSize(0)
	setSunSize(0)
	setBirdsEnabled(false)
	setAmbientSoundEnabled("general", false)
	setWorldSoundEnabled(0, 0, false, true)
	setWorldSoundEnabled(0, 29, false, true)
	setWorldSoundEnabled(0, 30, false, true)
	setWindVelocity(0, 0, 0)
	setPedVoice(getLocalPlayer(), "PED_TYPE_DISABLED", "")
	setWorldSpecialPropertyEnabled("randomfoliage", false)
	setWorldSpecialPropertyEnabled("extraairresistance", false)
	setOcclusionsEnabled(false)
	engineSetAsynchronousLoading(false, true)
	setBirdsEnabled(false)

	for g, h in pairs(a.graphic) do
		engineApplyShaderToWorldTexture(SHADER, tostring(h))
	end

end
addEventHandler("onClientResourceStart", getResourceRootElement(getThisResource()), increase)
addEventHandler("onPlayerJoin", getRootElement(), increase)

local i, j = guiGetScreenSize()
local k = 256
local l = 1

function handleMinimize()
	eightBitShader = dxCreateShader("assets/8bit.fx")
	screenSource = dxCreateScreenSource(i, j)
	setCloudsEnabled(false)
	setHeatHaze(0)
	setInteriorSoundsEnabled(false)
	setMoonSize(0)
	setOcclusionsEnabled(true)
	setSunSize(1)
	setBlurLevel(0)
	setCameraClip(false, false)
	engineSetAsynchronousLoading(false, true)
	setBirdsEnabled(false)
	setAmbientSoundEnabled("general", false)
	setWorldSoundEnabled(0, 0, false, true)
	setWorldSoundEnabled(0, 29, false, true)
	setWorldSoundEnabled(0, 30, false, true)
	setWindVelocity(0, 0, 0)
	setFarClipDistance(0)
	setFogDistance(0)
	setPedVoice(getLocalPlayer(), "PED_TYPE_DISABLED", "")
	setWorldSpecialPropertyEnabled("randomfoliage", false)
	setWorldSpecialPropertyEnabled("extraairresistance", false)
	screenSource:update()
	local m = {i / l, j / l}
	eightBitShader:setValue("screenSource", screenSource)
	eightBitShader:setValue("bitDepth", k)
	eightBitShader:setValue("tiles", m)
	dxDrawImage(0, 0, i, j, eightBitShader)
end
addEventHandler("onClientMinimize", root, handleMinimize)

function handleRestore()
	setHeatHaze(0)
	setInteriorSoundsEnabled(false)
	setBlurLevel(0)
	setCameraClip(false, false)
	removeWorldModel(616, 10000, 0, 0, 0)
	removeWorldModel(620, 10000, 0, 0, 0)
	removeWorldModel(673, 10000, 0, 0, 0)
	removeWorldModel(669, 10000, 0, 0, 0)
	removeWorldModel(621, 10000, 0, 0, 0)
	removeWorldModel(645, 10000, 0, 0, 0)
	removeWorldModel(712, 10000, 0, 0, 0)
	removeWorldModel(618, 10000, 0, 0, 0)
	removeWorldModel(661, 10000, 0, 0, 0)
	removeWorldModel(691, 10000, 0, 0, 0)
	removeWorldModel(715, 10000, 0, 0, 0)
	removeWorldModel(726, 10000, 0, 0, 0)
	removeWorldModel(625, 10000, 0, 0, 0)
	removeWorldModel(716, 10000, 0, 0, 0)
	removeWorldModel(733, 10000, 0, 0, 0)
	removeWorldModel(730, 10000, 0, 0, 0)
	removeWorldModel(708, 10000, 0, 0, 0)
	removeWorldModel(706, 10000, 0, 0, 0)
	removeWorldModel(707, 10000, 0, 0, 0)
	removeWorldModel(670, 10000, 0, 0, 0)
	removeWorldModel(727, 10000, 0, 0, 0)
	removeWorldModel(885, 10000, 0, 0, 0)
	removeWorldModel(791, 10000, 0, 0, 0)
	removeWorldModel(689, 10000, 0, 0, 0)
	removeWorldModel(690, 10000, 0, 0, 0)
	removeWorldModel(773, 10000, 0, 0, 0)
	removeWorldModel(729, 10000, 0, 0, 0)
	removeWorldModel(696, 10000, 0, 0, 0)
	removeWorldModel(672, 10000, 0, 0, 0)
	removeWorldModel(694, 10000, 0, 0, 0)
	removeWorldModel(790, 10000, 0, 0, 0)
	removeWorldModel(766, 10000, 0, 0, 0)
	removeWorldModel(768, 10000, 0, 0, 0)
	removeWorldModel(709, 10000, 0, 0, 0)
	removeWorldModel(693, 10000, 0, 0, 0)
	removeWorldModel(5292, 10000, 0, 0, 0)
	removeWorldModel(5295, 10000, 0, 0, 0)
	removeWorldModel(7076, 10000, 0, 0, 0)
	removeWorldModel(7077, 10000, 0, 0, 0)
	removeWorldModel(7078, 10000, 0, 0, 0)
	removeWorldModel(7080, 10000, 0, 0, 0)
	removeWorldModel(7086, 10000, 0, 0, 0)
	removeWorldModel(7543, 10000, 0, 0, 0)
	removeWorldModel(7563, 10000, 0, 0, 0)
	removeWorldModel(7569, 10000, 0, 0, 0)
	removeWorldModel(7573, 10000, 0, 0, 0)
	removeWorldModel(7598, 10000, 0, 0, 0)
	removeWorldModel(7607, 10000, 0, 0, 0)
	removeWorldModel(7608, 10000, 0, 0, 0)
	removeWorldModel(7637, 10000, 0, 0, 0)
	removeWorldModel(7640, 10000, 0, 0, 0)
	removeWorldModel(7648, 10000, 0, 0, 0)
	removeWorldModel(7649, 10000, 0, 0, 0)
	removeWorldModel(10669, 10000, 0, 0, 0)
	removeWorldModel(10712, 10000, 0, 0, 0)
	removeWorldModel(10736, 10000, 0, 0, 0)
	removeWorldModel(10738, 10000, 0, 0, 0)
	removeWorldModel(10739, 10000, 0, 0, 0)
	removeWorldModel(10742, 10000, 0, 0, 0)
	removeWorldModel(10743, 10000, 0, 0, 0)
	removeWorldModel(11561, 10000, 0, 0, 0)
	removeWorldModel(11608, 10000, 0, 0, 0)
	removeWorldModel(13205, 10000, 0, 0, 0)
	removeWorldModel(13451, 10000, 0, 0, 0)
	removeWorldModel(13452, 10000, 0, 0, 0)
	removeWorldModel(13863, 10000, 0, 0, 0)
	removeWorldModel(16044, 10000, 0, 0, 0)
	removeWorldModel(16046, 10000, 0, 0, 0)
	removeWorldModel(16268, 10000, 0, 0, 0)
	removeWorldModel(16284, 10000, 0, 0, 0)
	removeWorldModel(16373, 10000, 0, 0, 0)
	removeWorldModel(16741, 10000, 0, 0, 0)
	removeWorldModel(16743, 10000, 0, 0, 0)
	removeWorldModel(16745, 10000, 0, 0, 0)
	removeWorldModel(18211, 10000, 0, 0, 0)
	removeWorldModel(697, 10000, 0, 0, 0)
	removeWorldModel(3244, 10000, 0, 0, 0)
	removeWorldModel(8607, 10000, 0, 0, 0)
	removeWorldModel(8595, 10000, 0, 0, 0)
	removeWorldModel(8085, 10000, 0, 0, 0)
	removeWorldModel(8086, 10000, 0, 0, 0)
	removeWorldModel(713, 10000, 0, 0, 0)
	removeWorldModel(731, 10000, 0, 0, 0)
	removeWorldModel(772, 10000, 0, 0, 0)
	removeWorldModel(774, 10000, 0, 0, 0)
	removeWorldModel(705, 10000, 0, 0, 0)
	removeWorldModel(703, 10000, 0, 0, 0)
	removeWorldModel(688, 10000, 0, 0, 0)
	removeWorldModel(698, 10000, 0, 0, 0)
	removeWorldModel(658, 10000, 0, 0, 0)
	removeWorldModel(767, 10000, 0, 0, 0)
	removeWorldModel(652, 10000, 0, 0, 0)
	removeWorldModel(700, 10000, 0, 0, 0)
	removeWorldModel(687, 10000, 0, 0, 0)
	removeWorldModel(18271, 10000, 0, 0, 0)
	removeWorldModel(654, 10000, 0, 0, 0)
	removeWorldModel(655, 10000, 0, 0, 0)
	removeWorldModel(778, 10000, 0, 0, 0)
	removeWorldModel(737, 10000, 0, 0, 0)
	removeWorldModel(18268, 10000, 0, 0, 0)
	removeWorldModel(18327, 10000, 0, 0, 0)
	removeWorldModel(18270, 10000, 0, 0, 0)
	removeWorldModel(18272, 10000, 0, 0, 0)
	removeWorldModel(656, 10000, 0, 0, 0)
	removeWorldModel(735, 10000, 0, 0, 0)
	removeWorldModel(736, 10000, 0, 0, 0)
	removeWorldModel(763, 10000, 0, 0, 0)
	removeWorldModel(615, 10000, 0, 0, 0)
	removeWorldModel(775, 10000, 0, 0, 0)
	removeWorldModel(635, 10000, 0, 0, 0)
	removeWorldModel(710, 10000, 0, 0, 0)
	removeWorldModel(659, 10000, 0, 0, 0)
	removeWorldModel(676, 10000, 0, 0, 0)
	removeWorldModel(680, 10000, 0, 0, 0)
	removeWorldModel(738, 10000, 0, 0, 0)
	removeWorldModel(3509, 10000, 0, 0, 0)
	removeWorldModel(671, 10000, 0, 0, 0)
	removeWorldModel(7517, 10000, 0, 0, 0)
	removeWorldModel(622, 10000, 0, 0, 0)
	removeWorldModel(623, 10000, 0, 0, 0)
	removeWorldModel(1278, 10000, 0, 0, 0)
	removeWorldModel(3460, 10000, 0, 0, 0)
	removeWorldModel(1290, 10000, 0, 0, 0)
	removeWorldModel(1231, 10000, 0, 0, 0)
	removeWorldModel(7481, 10000, 0, 0, 0)
	removeWorldModel(7447, 10000, 0, 0, 0)
	removeWorldModel(651, 10000, 0, 0, 0)
	removeWorldModel(7462, 10000, 0, 0, 0)
	removeWorldModel(904, 10000, 0, 0, 0)
	removeWorldModel(858, 10000, 0, 0, 0)
	removeWorldModel(7483, 10000, 0, 0, 0)
	removeWorldModel(617, 10000, 0, 0, 0)
	removeWorldModel(7291, 10000, 0, 0, 0)
	removeWorldModel(6933, 10000, 0, 0, 0)
	removeWorldModel(6934, 10000, 0, 0, 0)
	removeWorldModel(6932, 10000, 0, 0, 0)
	removeWorldModel(1259, 10000, 0, 0, 0)
	removeWorldModel(739, 10000, 0, 0, 0)
	removeWorldModel(1391, 10000, 0, 0, 0)
	removeWorldModel(1388, 10000, 0, 0, 0)
	removeWorldModel(5838, 10000, 0, 0, 0)
	removeWorldModel(777, 10000, 0, 0, 0)
	removeWorldModel(770, 10000, 0, 0, 0)
	removeWorldModel(776, 10000, 0, 0, 0)
	removeWorldModel(764, 10000, 0, 0, 0)
	removeWorldModel(769, 10000, 0, 0, 0)
	removeWorldModel(771, 10000, 0, 0, 0)
	removeWorldModel(765, 10000, 0, 0, 0)
	removeWorldModel(1297, 10000, 0, 0, 0)
	removeWorldModel(733, 10000, 0, 0, 0)
	engineRemoveShaderFromWorldTexture(texShader, "collisionsmoke")
	setFarClipDistance(a.far)
	setFogDistance(a.far - 175)
	setCloudsEnabled(false)
	setMoonSize(0)
	setSunSize(0)
	setBirdsEnabled(false)
	setAmbientSoundEnabled("general", false)
	setWorldSoundEnabled(0, 0, false, true)
	setWorldSoundEnabled(0, 29, false, true)
	setWorldSoundEnabled(0, 30, false, true)
	setWindVelocity(0, 0, 0)
	setPedVoice(getLocalPlayer(), "PED_TYPE_DISABLED", "")
	setWorldSpecialPropertyEnabled("randomfoliage", false)
	setWorldSpecialPropertyEnabled("extraairresistance", false)
	setOcclusionsEnabled(false)
	engineSetAsynchronousLoading(false, true)
	setBirdsEnabled(false)

	for g, h in pairs(a.graphic) do
		engineApplyShaderToWorldTexture(SHADER, tostring(h))
	end

	if screenSource and eightBitShader then
		screenSource:destroy()
		screenSource = nil
		eightBitShader:destroy()
		eightBitShader = nil
	end
end
addEventHandler("onClientRestore", root, handleRestore)